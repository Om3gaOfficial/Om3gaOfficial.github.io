<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>ADM UE Grade Calculator</title>
    <link href="https://fonts.googleapis.com/css?family=Just%20Another%20Hand" rel="stylesheet">
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//wAA/+8AAP/vAACDgwAA/+8AAP/vAAD//wAA//8AAPf/AAD/uwAAwdcAAP/vAAD31wAA/7sAAP//AAD//wAA" rel="icon" type="image/x-icon" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container text-center">
      <div class="row">
        <div class="col-md col-lg-12">
          <h1 titel="Algebra and Discrete Mathematics Exercise Grade Calculator">ADM UE Grade Calculator</h1>
        </div>
      </div>
    </div>
    <form action="javascript:calculateGrade()">
      <div class="container-md">
        <div class="row">
          <div class="col-md justify-content-md-center">
            <label class="form-label formtxt">Grade Test 1</label>
            <input type="number" step="any" id="t1" class="form-control" placeholder="17" min="0" max="20" title="Enter your result of the first test">
          </div>
          <div class="col-md">
            <label class="form-label formtxt">Grade Test 2</label>
            <input type="number" step="any" id="t2" class="form-control" placeholder="20" min="0" max="20" title="Enter your result of the second test">
          </div>
          <div class="col-md">
            <label class="form-label formtxt">Grade Test 3</label>
            <input type="number" step="any" id="t3" class="form-control" placeholder="8" min="0" max="20" title="Enter your result of the third test">
          </div>
        </div>
        <div class="row justify-content-md-center">
          <div class="col-md col-lg-4">
            <label class="form-label formtxt">Crossed Assignments</label>
            <input type="number" step="any" id="k" class="form-control" placeholder="45" min="0" max="60" title="Enter the total number of assignments you will submit">
          </div>
          <div class="col-md col-lg-8">
            <label class="form-label formtxt">Board Performance</label>
            <input type="text" id="p" class="form-control" placeholder="8, 5, 10, ..." min="0" max="10" title="Enter your current board performance as a list separated by a ',' (comma)">
          </div>
        </div>
      </div>
      <div class="container text-center">
        <div class="row">
          <div class="col-md col-lg-12">
            <div class="">
              <button type="submit" id="button" class="btn btn-light" title="Click here to calculate your grade from the values you entered above">Calculate</button>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md col-lg">
            <a id="aGrade"><p id="grade" title="Pray!">This could be your Grade!</p></a>
          </div>
        </div>
      </div>
    </form>
  </body>
  <script>
    function roundToTwo(num) {
      return +(Math.round(num + "e+2")  + "e-2");
    }
    
    function calculateGrade() {
    try {
      var k = document.getElementById("k").value;
      var N = 60; // Number of assignments
      var t1 = document.getElementById("t1").value;
      var t2 = document.getElementById("t2").value;
      var t3 = document.getElementById("t3").value;
      var pArray = document.getElementById("p").value;
      
      var p = 0;
      var textGrade = "";

      if((k == "" || pArray == "" || pArray == " " || t1 == "" || t2 == "" || t3 == "")){
        if(k == "" && (pArray == "" || pArray == " ") && t1 == "" && t2 == "" && t3 == ""){
          return;
        }else{
          throw "#0";
      }
      }
      
      var pArray = pArray.split(",");
      for (var i = 0; i < pArray.length; i++) {
        temp = parseInt(pArray[i]);
        if(isNaN(temp) || temp < 0 || temp > 10){
          throw "#1";
        }
        p += temp;
      }
      p = p / pArray.length;
      
      
      var grade = (
        Math.floor(((5 * k) / (6 * N)) + 0.5)
        * Math.floor(((parseFloat(t1) + parseFloat(t2) + parseFloat(t3) - Math.min(parseFloat(t1), parseFloat(t2), parseFloat(t3))) / 40) + 0.5)
        * Math.floor((p / 8) + 0.5) * ((k / (5 * N)) + ((parseFloat(t1) + parseFloat(t2) + parseFloat(t3)) / 100) + (p / 50))
      );
      
      document.getElementById("aGrade").removeAttribute("href");
      document.getElementById("aGrade").style.color = "#000000";

      // Determine the grade
      if(0 <= grade && grade < 0.4){
        textGrade = "'Unsatisfactory!'  |  5"
        document.getElementById("grade").style.color = "#c41e16";
        document.getElementById("aGrade").href = "mailto:studienabteilung@tuwien.ac.at?subject=Exmatikulation";
        document.getElementById("aGrade").style.color = "#c41e16";
        document.getElementById("aGrade").style.textDecoration = "none";
      }else if (0.4 <= grade && grade < 0.55){
        textGrade = "'Sufficient'  |  4"
        document.getElementById("grade").style.color = "#CC5500";
      }else if (0.55 <= grade && grade < 0.7){
        textGrade = "'Satisfying'  |  3"
        document.getElementById("grade").style.color = "#039494";
      }else if (0.7 <= grade && grade < 0.85){
          textGrade = "'Good'  |  2"
          document.getElementById("grade").style.color = "#2e800b";
      }else if (0.85 <= grade && grade <= 1){
        textGrade = "'Very Good!'  |  1"
        document.getElementById("grade").style.color = "#58d124";
      }else{
        throw "#2";
      }
      
      document.getElementById("grade").innerHTML = textGrade + "<br>(" + roundToTwo(grade * 100) + "%)";
    
    } catch (e) {
      document.getElementById("grade").style.color = "#aa0000";
      document.getElementById("grade").innerHTML = "Error! Please check input values! (" + e + ")";
    }
    }
  </script>
</html>